<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Терновая гряда D&D</title>
    <style>
        body {
            font-family: 'Cinzel', serif;
            background-image: url('background.jpg');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            color: #d4af37;
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            overflow: auto;
        }
        .container {
            background: rgba(0, 0, 0, 0.7);
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 15px rgba(212, 175, 55, 0.5);
            width: 100%;
            max-width: 500px;
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .form-group {
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        label {
            margin-bottom: 0;
        }
        input[type="text"], select {
            width: 100%;
            padding: 8px;
            margin-bottom: 10px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid #d4af37;
            color: #d4af37;
            border-radius: 5px;
            font-family: 'Cinzel', serif;
        }
        .icon {
            width: 24px;
            height: 24px;
            fill: #d4af37;
        }
        .stat-group {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        .stat-value {
            width: 50px;
            text-align: center;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid #d4af37;
            border-radius: 5px;
            padding: 5px;
        }
        button {
            padding: 8px 15px;
            background: #d4af37;
            border: none;
            border-radius: 5px;
            color: #1a1a1a;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 0 10px rgba(212, 175, 55, 0.7);
        }
        button:hover {
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(212, 175, 55, 0.9);
        }
        button:active {
            transform: scale(0.95);
        }
        #submitBtn {
            display: block;
            width: 100%;
            margin-top: 20px;
        }
        .animated-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: inherit;
            z-index: -1;
            animation: bgShift 10s infinite linear;
        }
        @keyframes bgShift {
            0% { background-position: 0 0; }
            50% { background-position: 50px 50px; }
            100% { background-position: 0 0; }
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel&display=swap" rel="stylesheet">
</head>
<body>
    <div class="animated-bg"></div>
    <div class="container">
        <form id="characterForm">
            <div class="form-group">
                <label for="name">Имя персонажа:</label>
                <input type="text" id="name" required>
            </div>
            <div class="form-group">
                <label for="race">Раса:</label>
                <svg class="icon" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" /></svg>
                <select id="race">
                    <option value="Человек">Человек</option>
                    <option value="Эльф">Эльф</option>
                    <option value="Дварф">Дварф</option>
                    <option value="Гном">Гном</option>
                    <option value="Тифлинг">Тифлинг</option>
                    <option value="Полурослик">Полурослик</option>
                    <option value="Драконорожденный">Драконорожденный</option>
                    <option value="Орк">Орк</option>
                </select>
            </div>
            <div class="form-group">
                <label for="class">Класс:</label>
                <svg class="icon" viewBox="0 0 24 24"><rect x="5" y="5" width="14" height="14" /></svg>
                <select id="class">
                    <option value="Воин">Воин</option>
                    <option value="Варвар">Варвар</option>
                    <option value="Монах">Монах</option>
                    <option value="Чародей">Чародей</option>
                    <option value="Друид">Друид</option>
                    <option value="Волшебник">Волшебник</option>
                    <option value="Жрец">Жрец</option>
                    <option value="Паладин">Паладин</option>
                    <option value="Колдун">Колдун</option>
                    <option value="Следопыт">Следопыт</option>
                    <option value="Плут">Плут</option>
                </select>
            </div>
            <div class="form-group">
                <label>Характеристики (15 очков):</label>
                <div class="stat-group"><span>Сила:</span><button type="button" onclick="changeStat('strength', -1)">-</button><span class="stat-value" id="strength">8</span><button type="button" onclick="changeStat('strength', 1)">+</button></div>
                <div class="stat-group"><span>Ловкость:</span><button type="button" onclick="changeStat('dexterity', -1)">-</button><span class="stat-value" id="dexterity">8</span><button type="button" onclick="changeStat('dexterity', 1)">+</button></div>
                <div class="stat-group"><span>Телосложение:</span><button type="button" onclick="changeStat('constitution', -1)">-</button><span class="stat-value" id="constitution">8</span><button type="button" onclick="changeStat('constitution', 1)">+</button></div>
                <div class="stat-group"><span>Мудрость:</span><button type="button" onclick="changeStat('wisdom', -1)">-</button><span class="stat-value" id="wisdom">8</span><button type="button" onclick="changeStat('wisdom', 1)">+</button></div>
                <div class="stat-group"><span>Интеллект:</span><button type="button" onclick="changeStat('intelligence', -1)">-</button><span class="stat-value" id="intelligence">8</span><button type="button" onclick="changeStat('intelligence', 1)">+</button></div>
                <div class="stat-group"><span>Харизма:</span><button type="button" onclick="changeStat('charisma', -1)">-</button><span class="stat-value" id="charisma">8</span><button type="button" onclick="changeStat('charisma', 1)">+</button></div>
                <p>Осталось очков: <span id="pointsLeft">15</span></p>
            </div>
            <button type="submit" id="submitBtn">Создать персонажа</button>
        </form>
    </div>
    <script>
        let pointsLeft = 15;
        const maxStat = 20;
        const minStat = 8;

        function changeStat(stat, delta) {
            const value = parseInt(document.getElementById(stat).textContent);
            const newValue = value + delta;
            if (newValue >= minStat && newValue <= maxStat && pointsLeft - delta >= 0) {
                document.getElementById(stat).textContent = newValue;
                pointsLeft -= delta;
                document.getElementById('pointsLeft').textContent = pointsLeft;
            }
        }

        document.getElementById('characterForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const name = document.getElementById('name').value;
            const race = document.getElementById('race').value;
            const className = document.getElementById('class').value;
            const stats = {
                strength: parseInt(document.getElementById('strength').textContent),
                dexterity: parseInt(document.getElementById('dexterity').textContent),
                constitution: parseInt(document.getElementById('constitution').textContent),
                wisdom: parseInt(document.getElementById('wisdom').textContent),
                intelligence: parseInt(document.getElementById('intelligence').textContent),
                charisma: parseInt(document.getElementById('charisma').textContent)
            };

            if (pointsLeft !== 0) {
                alert('Распределите ровно 15 очков!');
                return;
            }

            const response = await fetch('/api/character', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ name, race, class: className, stats })
            });

            const data = await response.json();
            alert(data.message);
            if (response.ok) {
                document.getElementById('characterForm').reset();
                document.querySelectorAll('.stat-value').forEach(el => el.textContent = '8');
                pointsLeft = 15;
                document.getElementById('pointsLeft').textContent = pointsLeft;
            }
        });
    </script>
</body>
</html>