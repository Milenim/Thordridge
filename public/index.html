<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Терновая гряда D&D - Создание персонажа</title>
    <link rel="stylesheet" href="style.css">
    <style>
        body {
            padding: 20px;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }
        
        .page-container {
            width: 100%;
            max-width: 1600px;
            margin: 0 auto;
        }
        
        .main-container {
            display: grid;
            grid-template-columns: 1fr 1.2fr 1fr;
            gap: 25px;
            align-items: flex-start;
        }
        
        .form-container {
            min-width: 380px;
        }
        
        .race-info, .class-info {
            min-width: 380px;
            max-height: 75vh;
            overflow-y: auto;
        }
        
        .stat-container {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 10px;
            margin: 15px 0;
            padding: 12px;
            background: rgba(42, 42, 42, 0.6);
            border-radius: var(--border-radius);
            border: 1px solid var(--border-color);
            transition: var(--transition);
        }
        
        .stat-container:hover {
            border-color: var(--primary-gold);
            box-shadow: 0 0 10px rgba(212, 175, 55, 0.2);
        }
        
        .stat-container label {
            flex: 1;
            text-align: left;
            margin-bottom: 0;
            font-size: 1rem;
        }
        
        .stat-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .stat-container input {
            width: 60px;
            text-align: center;
            font-size: 1.1em;
            font-weight: bold;
            padding: 8px;
        }
        
        .stat-container button {
            width: 35px;
            height: 35px;
            padding: 0;
            font-size: 1.2rem;
            font-weight: bold;
            min-width: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .points {
            font-size: 1.2rem;
            margin: 18px 0;
            text-align: center;
            color: var(--primary-gold);
            font-weight: bold;
            padding: 12px;
            background: rgba(26, 26, 26, 0.8);
            border-radius: var(--border-radius);
            border: 2px solid var(--primary-gold);
        }
        
        .form-group {
            margin-bottom: 1.8rem;
        }
        
        .form-group input, .form-group select {
            font-size: 1rem;
            padding: 12px;
        }
        
        .form-group label {
            font-size: 1.1em;
            margin-bottom: 0.6rem;
        }
        
        .description-content {
            opacity: 0;
            transform: translateY(20px);
            animation: fadeIn 0.5s ease forwards;
            padding: 15px;
            background: rgba(26, 26, 26, 0.4);
            border-radius: var(--border-radius);
            margin-top: 10px;
        }
        
        .description-content.show {
            opacity: 1;
            transform: translateY(0);
        }
        
        .submit-button {
            width: 100%;
            padding: 15px;
            font-size: 1.2em;
            margin-top: 25px;
        }
        
        /* Планшетная версия */
        @media (max-width: 1400px) and (min-width: 769px) {
            .main-container {
                grid-template-columns: 1fr 1fr;
                gap: 20px;
            }
            
            .race-info {
                grid-column: 1 / 3;
                order: 3;
            }
            
            .form-container {
                order: 1;
            }
            
            .class-info {
                order: 2;
            }
        }
        
        /* Мобильная версия */
        @media (max-width: 768px) {
            body {
                padding: 15px;
                align-items: flex-start;
            }
            
            .page-container {
                width: 100%;
                display: flex;
                justify-content: center;
            }
            
            .main-container {
                display: block;
                gap: 20px;
                width: 100%;
                max-width: 100%;
            }
            
            .form-container, .race-info, .class-info {
                width: 100%;
                min-width: auto;
                margin: 0 auto 20px auto;
                max-width: 500px;
            }
            
            .race-info, .class-info {
                max-height: 60vh;
                overflow-y: auto;
            }
            
            .stat-container {
                padding: 12px;
            }
            
            .stat-container label {
                font-size: 1rem;
            }
            
            .stat-container input {
                width: 55px;
                font-size: 1.1em;
                padding: 6px;
            }
            
            .stat-container button {
                width: 40px;
                height: 40px;
                font-size: 1.3rem;
            }
            
            .points {
                font-size: 1.1rem;
                padding: 12px;
                margin: 15px 0;
            }
            
            .form-group input, .form-group select {
                font-size: 1rem;
                padding: 12px;
            }
            
            .submit-button {
                padding: 15px;
                font-size: 1.1em;
            }
        }
        
        /* Улучшенные описания */
        .race-info h2, .class-info h2 {
            margin-bottom: 15px;
            position: static;
            background: transparent;
            border: none;
            padding: 0;
        }
        
        .description-content strong {
            color: var(--primary-gold);
            font-size: 1em;
        }
        
        .description-content br + strong {
            display: block;
            margin-top: 12px;
        }
        
        /* Анимации */
        .container {
            animation: slideInUp 0.5s ease-out;
        }
        
        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .stat-container {
            animation: slideInLeft 0.3s ease-out;
        }
        
        .stat-container:nth-child(even) {
            animation: slideInRight 0.3s ease-out;
        }
        
        @keyframes slideInLeft {
            from {
                opacity: 0;
                transform: translateX(-15px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(15px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        /* Центрирование контента */
        .container {
            margin: 0 auto;
        }
        
        /* Улучшенные заголовки */
        h1 {
            font-size: 2.2rem;
        }
        
        h2 {
            font-size: 1.8rem;
        }
        
        h3 {
            font-size: 1.4rem;
        }
    </style>
</head>
<body>
    <div class="page-container">
        <div class="main-container">
            <div class="container race-info">
                <h2>Описание расы</h2>
                <div id="raceDescription" class="description-content">
                    <p>Выберите расу, чтобы увидеть её бонусы и умения.</p>
                </div>
            </div>
            
            <div class="container form-container">
                <h1 class="text-center">Создание персонажа</h1>
                <form id="characterForm">
                    <div class="form-group">
                        <label for="name">Имя персонажа:</label>
                        <input type="text" id="name" name="name" required placeholder="Введите имя персонажа">
                    </div>

                    <div class="form-group">
                        <label for="race">Раса:</label>
                        <select id="race" name="race" required onchange="applyRaceBonuses()">
                            <option value="" selected>Выберите расу</option>
                            <option value="Человек">Человек</option>
                            <option value="Драконорождённый">Драконорождённый</option>
                            <option value="Гном">Гном</option>
                            <option value="Тифлинг">Тифлинг</option>
                            <option value="Полуэльф">Полуэльф</option>
                            <option value="Полуорк">Полуорк</option>
                            <option value="Дварф">Дварф</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="class">Класс:</label>
                        <select id="class" name="class" required onchange="applyClassDescription()">
                            <option value="" selected>Выберите класс</option>
                            <option value="Воин">Воин</option>
                            <option value="Варвар">Варвар</option>
                            <option value="Монах">Монах</option>
                            <option value="Чародей">Чародей</option>
                            <option value="Друид">Друид</option>
                            <option value="Волшебник">Волшебник</option>
                            <option value="Жрец">Жрец</option>
                            <option value="Паладин">Паладин</option>
                            <option value="Колдун">Колдун</option>
                            <option value="Следопыт">Следопыт</option>
                            <option value="Плут">Плут</option>
                        </select>
                    </div>

                    <h3 class="text-center">Характеристики</h3>
                    <div class="points">Осталось очков: <span id="points">15</span></div>
                    
                    <div class="stat-container">
                        <label for="strength">Сила:</label>
                        <div class="stat-controls">
                            <button type="button" id="strengthDec" onclick="changeStat('strength', -1)" disabled>-</button>
                            <input type="number" id="strength" name="strength" value="8" min="8" max="20" readonly>
                            <button type="button" id="strengthInc" onclick="changeStat('strength', 1)" disabled>+</button>
                        </div>
                    </div>
                    
                    <div class="stat-container">
                        <label for="dexterity">Ловкость:</label>
                        <div class="stat-controls">
                            <button type="button" id="dexterityDec" onclick="changeStat('dexterity', -1)" disabled>-</button>
                            <input type="number" id="dexterity" name="dexterity" value="8" min="8" max="20" readonly>
                            <button type="button" id="dexterityInc" onclick="changeStat('dexterity', 1)" disabled>+</button>
                        </div>
                    </div>
                    
                    <div class="stat-container">
                        <label for="constitution">Телосложение:</label>
                        <div class="stat-controls">
                            <button type="button" id="constitutionDec" onclick="changeStat('constitution', -1)" disabled>-</button>
                            <input type="number" id="constitution" name="constitution" value="8" min="8" max="20" readonly>
                            <button type="button" id="constitutionInc" onclick="changeStat('constitution', 1)" disabled>+</button>
                        </div>
                    </div>
                    
                    <div class="stat-container">
                        <label for="wisdom">Мудрость:</label>
                        <div class="stat-controls">
                            <button type="button" id="wisdomDec" onclick="changeStat('wisdom', -1)" disabled>-</button>
                            <input type="number" id="wisdom" name="wisdom" value="8" min="8" max="20" readonly>
                            <button type="button" id="wisdomInc" onclick="changeStat('wisdom', 1)" disabled>+</button>
                        </div>
                    </div>
                    
                    <div class="stat-container">
                        <label for="intelligence">Интеллект:</label>
                        <div class="stat-controls">
                            <button type="button" id="intelligenceDec" onclick="changeStat('intelligence', -1)" disabled>-</button>
                            <input type="number" id="intelligence" name="intelligence" value="8" min="8" max="20" readonly>
                            <button type="button" id="intelligenceInc" onclick="changeStat('intelligence', 1)" disabled>+</button>
                        </div>
                    </div>
                    
                    <div class="stat-container">
                        <label for="charisma">Харизма:</label>
                        <div class="stat-controls">
                            <button type="button" id="charismaDec" onclick="changeStat('charisma', -1)" disabled>-</button>
                            <input type="number" id="charisma" name="charisma" value="8" min="8" max="20" readonly>
                            <button type="button" id="charismaInc" onclick="changeStat('charisma', 1)" disabled>+</button>
                        </div>
                    </div>
                    
                    <div id="error" class="error" style="display: none;"></div>
                    <button type="submit" class="submit-button">Создать персонажа</button>
                </form>
            </div>
            
            <div class="container class-info">
                <h2>Описание класса</h2>
                <div id="classDescription" class="description-content">
                    <p>Выберите класс, чтобы увидеть его описание.</p>
                </div>
            </div>
        </div>
    </div>
    
    <div class="modal" id="successModal">
        <div class="modal-content">
            <p id="modalMessage"></p>
            <button onclick="closeModal()">Продолжить</button>
        </div>
    </div>

    <script>
        const maxPoints = 15;
        let points = maxPoints;
        let baseStats = { strength: 8, dexterity: 8, constitution: 8, wisdom: 8, intelligence: 8, charisma: 8 };
        let minStats = { strength: 8, dexterity: 8, constitution: 8, wisdom: 8, intelligence: 8, charisma: 8 };

        const raceBonuses = {
            'Человек': {
                bonuses: { strength: 1, dexterity: 1, constitution: 1, wisdom: 1, intelligence: 1, charisma: 1 },
                description: `
                    <strong>Человек</strong><br>
                    <strong>Увеличение характеристик:</strong> Значение всех ваших характеристик увеличивается на 1.<br>
                    <strong>Возраст:</strong> Люди становятся взрослыми в районе 20 лет, и живут менее столетия.<br>
                    <strong>Мировоззрение:</strong> Люди не имеют склонности к определённому мировоззрению. Среди них встречаются как лучшие, так и худшие представители.<br>
                    <strong>Размер:</strong> Люди сильно различаются по размерам. Некоторые с трудом достигают 5 футов (152 см) ростом, тогда как другие имеют рост, превосходящий 6 футов (183 см). Ваш размер — Средний.<br>
                    <strong>Скорость:</strong> Ваша базовая скорость перемещения составляет 30 футов.<br>
                    <strong>Языки:</strong> Вы можете говорить, читать и писать на Общем и ещё одном языке на ваш выбор. Люди обычно изучают языки народов, с которыми имеют дело, включая редкие диалекты.
                `
            },
            'Драконорождённый': {
                bonuses: { strength: 2, charisma: 1 },
                description: `
                    <strong>Драконорождённый</strong><br>
                    <strong>Увеличение характеристик:</strong> Значение вашей Силы увеличивается на 2, а Харизмы — на 1.<br>
                    <strong>Возраст:</strong> Юные драконорождённые растут быстро. Они начинают ходить через час после вылупления, к трём годам достигают роста и сложения 10-летнего человека, и становятся взрослыми в 15. Живут они примерно до 80 лет.<br>
                    <strong>Мировоззрение:</strong> Драконорождённые склонны к крайностям, сознательно выбирая сторону добра или зла. Большинство добры, но те, кто принял сторону Тиамат, могут быть чрезвычайно жестокими.<br>
                    <strong>Размер:</strong> Драконорождённые выше и тяжелее людей, их рост около 6 футов (2 м) и вес около 250 фунтов (115 кг). Ваш размер — Средний.<br>
                    <strong>Скорость:</strong> Ваша базовая скорость перемещения составляет 30 футов.<br>
                    <strong>Наследие драконов:</strong> Выберите тип дракона. Вы получаете оружие дыхания и сопротивление к урону соответствующего вида.<br>
                    <strong>Оружие дыхания:</strong> Вы можете действием выдохнуть разрушительную энергию. Сложность спасброска: 8 + модификатор Телосложения + бонус мастерства. Урон: 2к6 (3к6 на 6 уровне, 4к6 на 11, 5к6 на 16). Перезарядка после отдыха.<br>
                    <strong>Сопротивление урону:</strong> Сопротивление к урону, указанному в вашем наследие драконов.<br>
                    <strong>Языки:</strong> Вы можете говорить, читать и писать на Общем и Драконьем языках.
                `
            },
            'Гном': {
                bonuses: { intelligence: 2 },
                description: `
                    <strong>Гном</strong><br>
                    <strong>Увеличение характеристик:</strong> Значение вашего Интеллекта увеличивается на 2.<br>
                    <strong>Возраст:</strong> Гномы взрослеют с той же скоростью, что и люди, и к 40 годам переходят к спокойной взрослой жизни. Они живут от 350 до почти 500 лет.<br>
                    <strong>Мировоззрение:</strong> Гномы чаще всего добры. Стремящиеся к порядку становятся мудрецами, инженерами, учёными. Склонные к хаосу — менестрелями, мошенниками, ювелирами.<br>
                    <strong>Размер:</strong> Рост гномов между 3 и 4 футами (91–122 см), средний вес — 40 фунтов (18 кг). Ваш размер — Маленький.<br>
                    <strong>Скорость:</strong> Ваша базовая скорость перемещения равна 25 футам.<br>
                    <strong>Тёмное зрение:</strong> На расстоянии 60 футов вы видите в темноте как при тусклом освещении, а при тусклом — как при ярком. В темноте различаете только оттенки серого.<br>
                    <strong>Гномья хитрость:</strong> Преимущество на спасброски Интеллекта, Мудрости и Харизмы против магии.<br>
                    <strong>Языки:</strong> Вы можете говорить, читать и писать на Общем и Гномьем языках.
                `
            },
            'Тифлинг': {
                bonuses: { intelligence: 1, charisma: 2 },
                description: `
                    <strong>Тифлинг</strong><br>
                    <strong>Увеличение характеристик:</strong> Значение вашего Интеллекта увеличивается на 1, а Харизмы — на 2.<br>
                    <strong>Возраст:</strong> Тифлинги взрослеют как люди, но живут немного дольше.<br>
                    <strong>Мировоззрение:</strong> Тифлинги склонны к хаотичному мировоззрению, независимы по природе.<br>
                    <strong>Размер:</strong> Тифлинги схожи с людьми по росту и телосложению. Ваш размер — Средний.<br>
                    <strong>Скорость:</strong> Ваша базовая скорость перемещения — 30 футов.<br>
                    <strong>Тёмное зрение:</strong> На расстоянии 60 футов вы видите в темноте как при тусклом освещении, а при тусклом — как при ярком. В темноте различаете только оттенки серого.<br>
                    <strong>Адское сопротивление:</strong> Сопротивление урону огнём.<br>
                    <strong>Дьявольское наследие:</strong> Знаете заклинание чудотворство. С 3 уровня — адское возмездие (1/день, 2 уровень). С 5 уровня — тьма (1/день). Базовая характеристика — Харизма.<br>
                    <strong>Языки:</strong> Вы можете говорить, читать и писать на Общем и Инфернальном.
                `
            },
            'Полуэльф': {
                bonuses: { charisma: 2, custom: 2 },
                description: `
                    <strong>Полуэльф</strong><br>
                    <strong>Увеличение характеристик:</strong> Значение вашей Харизмы увеличивается на 2, а двух других характеристик на ваш выбор — на 1.<br>
                    <strong>Возраст:</strong> Полуэльфы взрослеют как люди, достигая зрелости к 20 годам, но живут до 180 лет.<br>
                    <strong>Мировоззрение:</strong> Полуэльфы склонны к хаосу, ценят личную свободу и творческое самовыражение.<br>
                    <strong>Размер:</strong> Полуэльфы почти такого же размера, как люди, рост от 5 до 6 футов (155–183 см). Ваш размер — Средний.<br>
                    <strong>Скорость:</strong> Базовая скорость перемещения — 30 футов.<br>
                    <strong>Тёмное зрение:</strong> На расстоянии 60 футов вы видите в темноте как при тусклом освещении, а при тусклом — как при ярком. В темноте различаете только оттенки серого.<br>
                    <strong>Наследие фей:</strong> Преимущество на спасброски от очарования, и вас невозможно магически усыпить.<br>
                    <strong>Универсальность навыков:</strong> Владение двумя навыками на ваш выбор.<br>
                    <strong>Языки:</strong> Вы можете говорить, читать и писать на Общем, Эльфийском и ещё одном языке на ваш выбор.
                `
            },
            'Полуорк': {
                bonuses: { strength: 2, constitution: 1 },
                description: `
                    <strong>Полуорк</strong><br>
                    <strong>Увеличение характеристик:</strong> Значение вашей Силы увеличивается на 2, а Телосложения — на 1.<br>
                    <strong>Возраст:</strong> Полуорки взрослеют к 14 годам, живут до 75 лет.<br>
                    <strong>Мировоззрение:</strong> Полуорки склонны к хаосу и не особо к добру. Выросшие среди орков часто злы.<br>
                    <strong>Размер:</strong> Полуорки выше и массивнее людей, рост от 5 до 6 футов (152–185 см). Ваш размер — Средний.<br>
                    <strong>Скорость:</strong> Ваша базовая скорость перемещения — 30 футов.<br>
                    <strong>Тёмное зрение:</strong> На расстоянии 60 футов вы видите в темноте как при тусклом освещении, а при тусклом — как при ярком. В темноте различаете только оттенки серого.<br>
                    <strong>Угрожающий вид:</strong> Владение навыком Запугивание.<br>
                    <strong>Непоколебимая стойкость:</strong> Если хиты опустились до 0, но вы не убиты, хиты становятся 1 (1/день).<br>
                    <strong>Свирепые атаки:</strong> При критическом попадании рукопашной атакой оружием добавляется одна кость урона.<br>
                    <strong>Языки:</strong> Вы можете говорить, читать и писать на Общем и Орочьем.
                `
            },
            'Дварф': {
                bonuses: { constitution: 2 },
                description: `
                    <strong>Дварф</strong><br>
                    <strong>Увеличение характеристик:</strong> Значение вашего Телосложения увеличивается на 2.<br>
                    <strong>Возраст:</strong> Дварфы взрослеют с той же скоростью, что и люди, но считаются молодыми до 50 лет. В среднем они живут около 350 лет.<br>
                    <strong>Мировоззрение:</strong> Большинство дварфов законопослушны, с сильным чувством чести и веры в традиции.<br>
                    <strong>Размер:</strong> Дварфы в среднем от 4 до 5 футов ростом (122–152 см) и весят около 150 фунтов (68 кг). Ваш размер — Средний.<br>
                    <strong>Скорость:</strong> Ваша базовая скорость перемещения — 25 футов. Ваша скорость не уменьшается при ношении тяжёлых доспехов.<br>
                    <strong>Тёмное зрение:</strong> На расстоянии 60 футов вы видите в темноте как при тусклом освещении, а при тусклом — как при ярком. В темноте различаете только оттенки серого.<br>
                    <strong>Дварфская стойкость:</strong> Преимущество на спасброски против яда и сопротивление урону ядом.<br>
                    <strong>Знание оружия:</strong> Владение боевым топором, ручным топором, лёгким молотом и боевым молотом.<br>
                    <strong>Знание инструментов:</strong> Владение одним из инструментов на выбор: кузнечные, пивоваренные или каменщицкие.<br>
                    <strong>Знание камня:</strong> При проверке Интеллекта (История), связанной с каменными изделиями, ваш бонус мастерства удваивается.<br>
                    <strong>Языки:</strong> Вы можете говорить, читать и писать на Общем и Дварфском.
                `
            }
        };

        const classDescriptions = {
            'Воин': `
                <strong>Воин</strong><br>
                <strong>Описание:</strong> Воины — мастера боя, владеющие различным оружием и доспехами. Они могут быть рыцарями, наёмниками или защитниками.<br>
                <strong>Ключевая характеристика:</strong> Сила или Ловкость.<br>
                <strong>Особенности:</strong> Боевой стиль (например, Двуручное оружие или Защита), Вторая атака на 5 уровне.<br>
                <strong>Роль:</strong> Фронтовая линия, танк или урон.<br>
            `,
            'Варвар': `
                <strong>Варвар</strong><br>
                <strong>Описание:</strong> Варвары черпают силу из ярости, становясь практически непробиваемыми в бою. Они часто приходят из диких земель.<br>
                <strong>Ключевая характеристика:</strong> Сила.<br>
                <strong>Особенности:</strong> Ярость, Неразрушимость на 5 уровне.<br>
                <strong>Роль:</strong> Фронтовая линия, урон.<br>
            `,
            'Монах': `
                <strong>Монах</strong><br>
                <strong>Описание:</strong> Монахи — мастера боевых искусств, использующие ловкость и внутреннюю энергию (ки). Они тренируются в монастырях.<br>
                <strong>Ключевая характеристика:</strong> Ловкость и Мудрость.<br>
                <strong>Особенности:</strong> Бездоспешный бой, Поражающий удар на 3 уровне.<br>
                <strong>Роль:</strong> Урон, контроль.<br>
            `,
            'Чародей': `
                <strong>Чародей</strong><br>
                <strong>Описание:</strong> Чародеи рождаются с врождённой магической силой, которую используют инстинктивно. Их магия часто связана с кровью или судьбой.<br>
                <strong>Ключевая характеристика:</strong> Харизма.<br>
                <strong>Особенности:</strong> Гибкие чары, Метамагические возможности на 3 уровне.<br>
                <strong>Роль:</strong> Урон, поддержка.<br>
            `,
            'Друид': `
                <strong>Друид</strong><br>
                <strong>Описание:</strong> Друиды черпают силу из природы, способны превращаться в животных и использовать природную магию.<br>
                <strong>Ключевая характеристика:</strong> Мудрость.<br>
                <strong>Особенности:</strong> Дикая форма, Круг друида на 2 уровне.<br>
                <strong>Роль:</strong> Поддержка, контроль, исцеление.<br>
            `,
            'Волшебник': `
                <strong>Волшебник</strong><br>
                <strong>Описание:</strong> Волшебники изучают магию через книги и исследования, владея широким спектром заклинаний.<br>
                <strong>Ключевая характеристика:</strong> Интеллект.<br>
                <strong>Особенности:</strong> Арканальная традиция на 2 уровне, Подготовка заклинаний.<br>
                <strong>Роль:</strong> Урон, контроль, поддержка.<br>
            `,
            'Жрец': `
                <strong>Жрец</strong><br>
                <strong>Описание:</strong> Жрецы служат божественным силам, используя магию для исцеления и защиты союзников.<br>
                <strong>Ключевая характеристика:</strong> Мудрость.<br>
                <strong>Особенности:</strong> Домен божества на 1 уровне, Канал божественности.<br>
                <strong>Роль:</strong> Исцеление, поддержка.<br>
            `,
            'Паладин': `
                <strong>Паладин</strong><br>
                <strong>Описание:</strong> Паладины — святые воители, связывающие боевые навыки с божественной магией и клятвами.<br>
                <strong>Ключевая характеристика:</strong> Сила и Харизма.<br>
                <strong>Особенности:</strong> Божественная магия, Священная клятва на 3 уровне.<br>
                <strong>Роль:</strong> Фронтовая линия, поддержка.<br>
            `,
            'Колдун': `
                <strong>Колдун</strong><br>
                <strong>Описание:</strong> Колдуны заключают сделки с могущественными сущностями, получая магию в обмен на службу.<br>
                <strong>Ключевая характеристика:</strong> Харизма.<br>
                <strong>Особенности:</strong> Магический покров, Мистические аруаны на 2 уровне.<br>
                <strong>Роль:</strong> Урон, контроль.<br>
            `,
            'Следопыт': `
                <strong>Следопыт</strong><br>
                <strong>Описание:</strong> Следопыты — мастера выживания и охоты, эффективные против определённых врагов.<br>
                <strong>Ключевая характеристика:</strong> Ловкость и Мудрость.<br>
                <strong>Особенности:</strong> Избранный враг, Стиль боя на 2 уровне.<br>
                <strong>Роль:</strong> Урон, разведка.<br>
            `,
            'Плут': `
                <strong>Плут</strong><br>
                <strong>Описание:</strong> Плуты полагаются на хитрость, ловкость и скрытность, часто действуя из тени.<br>
                <strong>Ключевая характеристика:</strong> Ловкость.<br>
                <strong>Особенности:</strong> Мастер скрытности, Удар исподтишка на 3 уровне.<br>
                <strong>Роль:</strong> Урон, разведка.<br>
            `
        };

        function applyRaceBonuses() {
            const raceSelect = document.getElementById('race');
            const race = raceSelect.value;
            const buttons = document.querySelectorAll('.stat-container button');

            // Сброс к базовым значениям
            for (let stat in baseStats) {
                document.getElementById(stat).value = baseStats[stat];
                minStats[stat] = baseStats[stat];
            }
            points = maxPoints;

            // Активация/деактивация кнопок
            if (!race) {
                for (let stat in baseStats) {
                    document.getElementById(stat).value = 8;
                    minStats[stat] = 8;
                }
                points = maxPoints;
                buttons.forEach(button => button.disabled = true);
            } else {
                buttons.forEach(button => button.disabled = false);
                if (raceBonuses[race]) {
                    const bonuses = raceBonuses[race].bonuses;
                    for (let stat in bonuses) {
                        if (stat === 'custom') {
                            document.getElementById('strength').value = baseStats.strength + 1;
                            document.getElementById('dexterity').value = baseStats.dexterity + 1;
                            minStats.strength = baseStats.strength + 1;
                            minStats.dexterity = baseStats.dexterity + 1;
                        } else {
                            const bonus = bonuses[stat];
                            const newValue = baseStats[stat] + bonus;
                            document.getElementById(stat).value = newValue;
                            minStats[stat] = newValue;
                        }
                    }
                }
            }

            document.getElementById('points').textContent = points;
            updateDescription();
        }

        function changeStat(stat, change) {
            const input = document.getElementById(stat);
            let value = parseInt(input.value);
            const newValue = value + change;
            if (newValue >= minStats[stat] && newValue <= 20 && points - change >= 0) {
                input.value = newValue;
                points -= change;
                document.getElementById('points').textContent = points;
            }
        }

        function updateDescription() {
            const race = document.getElementById('race').value;
            const descriptionDiv = document.getElementById('raceDescription');
            descriptionDiv.classList.remove('show');
            
            setTimeout(() => {
                if (raceBonuses[race]) {
                    descriptionDiv.innerHTML = raceBonuses[race].description;
                } else {
                    descriptionDiv.innerHTML = '<p>Выберите расу, чтобы увидеть её бонусы и умения.</p>';
                }
                descriptionDiv.classList.add('show');
            }, 150);
        }

        function applyClassDescription() {
            const classSelect = document.getElementById('class');
            const className = classSelect.value;
            const descriptionDiv = document.getElementById('classDescription');
            descriptionDiv.classList.remove('show');
            
            setTimeout(() => {
                if (classDescriptions[className]) {
                    descriptionDiv.innerHTML = classDescriptions[className];
                } else {
                    descriptionDiv.innerHTML = '<p>Выберите класс, чтобы увидеть его описание.</p>';
                }
                descriptionDiv.classList.add('show');
            }, 150);
        }

        function showModal(message, redirectUrl) {
            const modal = document.getElementById('successModal');
            const modalMessage = document.getElementById('modalMessage');
            modalMessage.textContent = message;
            modal.style.display = 'flex';
            setTimeout(() => {
                if (redirectUrl) {
                    window.location.href = redirectUrl;
                }
            }, 2000);
        }

        function closeModal() {
            const modal = document.getElementById('successModal');
            modal.style.display = 'none';
        }

        window.onload = function() {
            const buttons = document.querySelectorAll('.stat-container button');
            buttons.forEach(button => button.disabled = true);

            document.getElementById('characterForm').addEventListener('submit', async (e) => {
                e.preventDefault();
                const name = document.getElementById('name').value.trim();
                const race = document.getElementById('race').value;
                const charClass = document.getElementById('class').value;
                const stats = {
                    strength: parseInt(document.getElementById('strength').value),
                    dexterity: parseInt(document.getElementById('dexterity').value),
                    constitution: parseInt(document.getElementById('constitution').value),
                    wisdom: parseInt(document.getElementById('wisdom').value),
                    intelligence: parseInt(document.getElementById('intelligence').value),
                    charisma: parseInt(document.getElementById('charisma').value)
                };

                const errorDiv = document.getElementById('error');
                errorDiv.style.display = 'none';

                if (!name || !race || !charClass) {
                    errorDiv.textContent = 'Заполните все поля: имя, раса, класс';
                    errorDiv.style.display = 'block';
                    return;
                }

                if (points !== 0) {
                    errorDiv.textContent = 'Распределите все 15 очков характеристик';
                    errorDiv.style.display = 'block';
                    return;
                }

                const characterData = {
                    name,
                    race,
                    class: charClass,
                    stats
                };

                try {
                    const response = await fetch('/api/character', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(characterData)
                    });
                    const result = await response.json();
                    if (response.ok) {
                        showModal(result.message, `/gameplay.html?characterId=${result.characterId}`);
                    } else {
                        errorDiv.textContent = result.message;
                        errorDiv.style.display = 'block';
                    }
                } catch (err) {
                    console.error('Error creating character:', err);
                    errorDiv.textContent = 'Ошибка при создании персонажа';
                    errorDiv.style.display = 'block';
                }
            });
        };
    </script>
</body>
</html>